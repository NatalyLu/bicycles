window.util={ESC_KEYCODE:27,ENTER_KEYCODE:13,FORM_ACTION:"https://echo.htmlacademy.ru/",body:document.querySelector("body"),burger:document.querySelector("#burger"),mainNav:document.querySelector(".main-nav"),removeClasses:(e,t)=>{t.map(t=>{e.classList.contains(t)&&e.classList.remove(t)})},closeOrOpenMenu:e=>{let t;return e.classList.contains("active")&&window.util.burger.classList.contains("open")?(window.util.body.classList.remove("menu-open"),window.util.burger.classList.remove("open"),t="false",e.classList.remove("menu-is-open")):(window.util.body.classList.add("menu-open"),window.util.burger.classList.add("open"),t="true",e.classList.add("menu-is-open")),t}},function(){const e=window.util.mainNav;e.classList.add("active"),window.util.burger.classList.remove("open"),window.util.burger.addEventListener("click",n=>{n.preventDefault(),t(n,e)}),window.util.burger.addEventListener("keydown",n=>{n.keyCode===window.util.ENTER_KEYCODE&&t(n,e)});let t=(e,t)=>{e.preventDefault(),window.util.burger.setAttribute("aria-expanded",window.util.closeOrOpenMenu(t))}}();let e=e=>{let t;cancelAnimationFrame(t);let n=performance.now(),o=window.pageYOffset||document.documentElement.scrollTop,a=document.querySelector(e).getBoundingClientRect().top,i=.4*Math.abs(a);requestAnimationFrame((function e(r){var s=(r-n)/i;1<=s&&(s=1),window.scrollTo(0,o+a*s|0),1>s&&(t=requestAnimationFrame(e)),document.addEventListener("wheel",(function(){cancelAnimationFrame(t)}))}))};window.util.mainNav.querySelector(".main-nav__list").addEventListener("click",t=>{t.preventDefault();let n=t.target.getAttribute("href");window.util.closeOrOpenMenu(window.util.mainNav),setTimeout(()=>{e(n)},300)}),function(){let e=document.querySelector(".form"),t="error",n="success",o=!0,a="",i="",r=e.querySelector("[name='phone']"),s=e.querySelector("[name='name']");try{a=localStorage.getItem("userPhone"),i=localStorage.getItem("userName")}catch(e){o=!1}let l=e=>{let n=e.querySelector("input[name='phone']"),o=0;return/^(\+7|7|8)?[\s-]?\(?[489][0-9]{2}\)?[\s-]?[0-9]{3}[\s-]?[0-9]{2}[\s-]?[0-9]{2}$/.test(n.value)?window.util.removeClasses(n.parentElement,[t]):(n.parentElement.classList.add(t),o++),o},u=(e,t)=>{e.reset(),e.classList.add(t)};localStorage&&(r.value=a,s.value=i),e.addEventListener("submit",a=>{a.preventDefault(),(async(e,a,i)=>{if(e.preventDefault(),window.util.removeClasses(a,[t,n]),0===l(a)){o&&(localStorage.setItem("userPhone",r.value),localStorage.setItem("userName",s.value)),(await fetch(i,{method:"POST",body:new FormData(a)})).ok?u(a,n):u(a,t)}})(a,e,window.util.FORM_ACTION)}),e.addEventListener("input",o=>{window.util.removeClasses(o.target.parentElement,[t]),window.util.removeClasses(e,[t,n])})}();