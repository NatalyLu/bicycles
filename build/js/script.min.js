window.util={ESC_KEYCODE:27,ENTER_KEYCODE:13,FORM_ACTION:"https://echo.htmlacademy.ru/",body:document.querySelector("body"),burger:document.querySelector("#burger"),list:document.querySelector(".main-nav__list"),removeClasses:(e,t)=>{t.map(t=>{e.classList.contains(t)&&e.classList.remove(t)})},closeOrOpenMenu:e=>{let t;return window.util.burger.classList.contains("active")&&window.util.burger.classList.contains("open")?(window.util.body.classList.remove("menu-open"),window.util.burger.classList.remove("open"),t="false",e.classList.add("element-hidden")):(window.util.body.classList.add("menu-open"),window.util.burger.classList.add("open"),t="true",e.classList.remove("element-hidden")),t}},function(){window.util.burger.classList.add("active"),window.util.burger.classList.remove("open"),window.util.list.classList.add("element-hidden"),window.util.list.classList.add("active"),window.util.burger.addEventListener("click",t=>{t.preventDefault(),e(t,window.util.list)}),window.util.burger.addEventListener("keydown",t=>{t.keyCode===window.util.ENTER_KEYCODE&&e(t,window.util.list)});let e=(e,t)=>{e.preventDefault(),window.util.burger.setAttribute("aria-expanded",window.util.closeOrOpenMenu(t))}}();let e=e=>{let t;cancelAnimationFrame(t);let n=performance.now(),i=window.pageYOffset||document.documentElement.scrollTop,l=document.querySelector(e).getBoundingClientRect().top,o=.4*Math.abs(l);requestAnimationFrame((function e(s){var r=(s-n)/o;1<=r&&(r=1),window.scrollTo(0,i+l*r|0),1>r&&(t=requestAnimationFrame(e)),document.addEventListener("wheel",(function(){cancelAnimationFrame(t)}))}))};window.util.list.addEventListener("click",t=>{t.preventDefault();let n=t.target.getAttribute("href");window.util.closeOrOpenMenu(window.util.list),setTimeout(()=>{e(n)},300)}),function(){let e=document.querySelector(".form"),t="error",n="success",i=!0,l="",o="",s=e.querySelector("[name='phone']"),r=e.querySelector("[name='name']");try{l=localStorage.getItem("userPhone"),o=localStorage.getItem("userName")}catch(e){i=!1}let a=e=>{let n=e.querySelector("input[name='phone']"),i=0;return/^(\+7|7|8)?[\s-]?\(?[489][0-9]{2}\)?[\s-]?[0-9]{3}[\s-]?[0-9]{2}[\s-]?[0-9]{2}$/.test(n.value)?window.util.removeClasses(n.parentElement,[t]):(n.parentElement.classList.add(t),i++),i},u=(e,t)=>{e.reset(),e.classList.add(t)};localStorage&&(s.value=l,r.value=o),e.addEventListener("submit",l=>{l.preventDefault(),(async(e,l,o)=>{if(e.preventDefault(),window.util.removeClasses(l,[t,n]),0===a(l)){i&&(localStorage.setItem("userPhone",s.value),localStorage.setItem("userName",r.value)),(await fetch(o,{method:"POST",body:new FormData(l)})).ok?u(l,n):u(l,t)}})(l,e,window.util.FORM_ACTION)}),e.addEventListener("input",i=>{window.util.removeClasses(i.target.parentElement,[t]),window.util.removeClasses(e,[t,n])})}();